= Template Agnostic
:navtitle: Template Agnostic

One of the major advantages, besides being able to reuse model mappings, is that the transformation
of openEHR-to-FHIR is template agnostic.
FHIR has the problem that each initiative adds new fields in different ways.
In FHIR, this is done by adding extensions, and fields are often used differently.
A recent https://pubmed.ncbi.nlm.nih.gov/37128432/[publication] shows that 35% of the fields
contained in an implementation guide are extensions.
When converting back and forth between FHIR datasets, these fields can either be missing on
one side or provided in another profile, or they may be modeled differently.
This makes the transformation between FHIR initiatives lackluster, as an integration process has to deal with different representations and missing data that was not modeled.

FHIRconnect solves this issue.
The mappings defined from openEHR-to-FHIR are based on archetypes and map using extensions into a profile.
Therefore, if data is integrated into openEHR, from this archetype, we can export data into different profiles without having to change the data that was integrated into openEHR,
since archetypes are inclusive models and try to capture as much as possible in each model.

image::TemplateAgnostic.drawio.png[]

Here, two different templates populate different fields of the archetype.
The mapping is executed from openEHR-to-FHIR based on the archetype.
The extension mapping may change how some paths of the archetype are mapped to Profile 1 or Profile 2,
but this is independent of the template and relates to the profile.
Therefore, once we write a mapping for Profile 1, each archetype in an openEHR CDR can be mapped
to a specific profile (if no mandatory field is missing).
The downside here is that FHIR initiatives are modeled in smaller scopes, and the data
contained in archetypes is often not modeled, leading to data loss.

This provides the possibility to convert data between different FHIR projects in an easy manner, e.g. transforming
data from the german-core dataset (KDS) to the EEHRxF FHIR-profiles and back.

Meanwhile in FHIR, both contain a fields that does not match. There is no profile that
contain both extensions and regularity. So, for integrating between FHIR profiles, a new profile that
captures all three fields would need to be modeled. This profile would then need to be extended for each
new field introduced by a new initiative. If these fields are modeled differently between initiatives, it
results in even more integration processes. There are other more detailed problems (missing standardization
of composer, etc. pp).

image::TemplateAgnostic2.drawio.png[]

For mapping FHIR-to-openEHR, the template used can be seen as an ingest for the FHIR profile.
The template should still align with openEHR governance, etc., but FHIR profiles are mostly designed for exchange and
not for recording clinical data inside institutions.
Therefore, a split between data-capture and FHIR templates is sometimes recommended to
avoid infringing on the primary data-capture templates.
Hereby, it is important that the 1..1 fields are contained otherwise the mapping cannot be executed.


