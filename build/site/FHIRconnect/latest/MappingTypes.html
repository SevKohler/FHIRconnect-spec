<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Mapping types :: FHIRconnect</title>
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../..">FHIRconnect</a>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="FHIRconnect" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="index.html">FHIRconnect</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Grammar</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="types-of-mappings.html">Types of mappings</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="basics.html">Basic Concepts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="Conditions.html">Condition</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="FollowedBy.html">FollowedBy</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="SlotArchetypes.html">SlotArchetypes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="Reference.html">Reference</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="manual.html">Manual mappings</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="MappingTypes.html">Mapping types</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="HierarchyMappings.html">Hierarchy mappings</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="model-mappings.html">Model mappings</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="extension-mappings.html">Extension mappings</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="context-mappings.html">Context mappings</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="cardinality.html">Cardinality</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="links-and-references.html">Links and references</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="demographics.html">Demographics</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Engine</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="engine.html">Engine</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">FHIRconnect</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="index.html">FHIRconnect</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">FHIRconnect</a></li>
    <li>Grammar</li>
    <li><a href="MappingTypes.html">Mapping types</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="file:///home/severin/repos/FHIRconnect/modules/ROOT/pages/MappingTypes.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Mapping types</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>There are different types of mappings, in general most of it is autoresolved by the engine, since FHIRconnect
has no static typing. We can enforce types if we want to by using the <code>type:</code> key in the <code>with:</code> clause. Typically, you
will find this in use for <code>type: NONE</code> if you just want to iterate a path.
The types are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>NONE</p>
</li>
<li>
<p>QUANTITY</p>
</li>
<li>
<p>DATETIME</p>
</li>
<li>
<p>CODING</p>
</li>
<li>
<p>STRING</p>
</li>
<li>
<p>IDENTIFIER</p>
</li>
<li>
<p>HIERARCHY</p>
</li>
<li>
<p>PROGRAMMED</p>
</li>
<li>
<p>REFERENCED</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><mark>@Gasper what else do we have if we want to static type ? i dont like we add this but we have too&#8230;&#8203;
</mark>
<mark>Can you write here how you process these in the engine ? Like data type mappings
</mark></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_programmed_mappings"><a class="anchor" href="#_programmed_mappings"></a>Programmed mappings</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sometimes the FHIRconnect specification grammar is not enough and a mapping requires a very unique logic. For this the
Programmed mappings where introduced. Here a bit of code can be referenced that is executed by the engine. The way how
this code is provided and where is up to the vendor.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">  - name: "dosageTiming"
    with:
      fhir: "$fhirRoot.timing"
      openehr: "$archetype"
    # type: "PROGRAMMED" not necessary, mappingCode is unique for PROGRAMMED_MAPPINGS
    mappingCode: "timingToDaily_NonDaily" #FHIR and openEHR are here very different, openEHR uses ISO, FHIR made up their own</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_referenced_mappings"><a class="anchor" href="#_referenced_mappings"></a>Referenced mappings</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A composition could not contain an archetype (difference to slotArchetypes) to represent a specific resource in FHIR.
This composition can be another one to the one that is currently mapped. To redirect a part of the FHIR data
to a different FHIRconnect mapping the <code>$REFERENCED_MAPPING</code> can be used. Hereby, the engine needs to checks
the <code>meta.url</code> contained in the FHIR resource and search the available FHIRconnect context mappings. If a context mapping
for this <code>meta.url</code> is contained, it is executed and saved as a separate composition. This composition is linked using the
openEHR <a href="https://specifications.openehr.org/releases/RM/latest/common.html#_link_class">links</a>. The fields of this
link are set in the <code>openEHRLink</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">  - name: "partOf"
    with:
      fhir: "$resource.partOf.reference"
      openehr: "$reference"
    reference:
      mappings:
        - name: "partOfReference"
          with:
            fhir: "$fhirRoot"
            openehr: "$archetype/links" # will use link
            # type: "REFERENCED" not necessary due to dynamic typing (openehrLink is unique for Referenced...)
          openehrLink:
            meaning: "Part of referenced event"
            type: "partOf"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_hierarchy_mappings"><a class="anchor" href="#_hierarchy_mappings"></a>Hierarchy mappings</h2>
<div class="sectionbody">
<div class="paragraph">
<p>These are the most complex type of mappings. Sometimes the hierarchy between a fhir and an openEHR model do not fit.
They are just in different levels of the files.
A good example is the FHIR MedicationStatement. Without going into detail why the models are differently aligned there
is the problem that in FHIR the medication is part of the statement, but in openEHR it is part of an EVENT of the .
MedicationStatement.
This leads to several problems now, first of all for each route we have in FHIR we need to create a new EVENT in openEHR.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/MappingHierarchies.png" alt="MappingHierarchies">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">  - name: "hierarchyMappings" # is defined by the
    with:
      fhir: "$resource.dosage"
      openEHR: "$archetype/data[at0001]/events[at0002]"
  #    type: "HIERARCHY" not necessary since hierarchy is a unique key for Hierarchy mappings
    hierarchy:
      fhirCreate: "resource"
      openehrCreate: "event"
      uniqueValueFHIR: "[route, timing.event]" # if route value is different per dosage slice make a new event
      uniqueValueOpenEHR: "['/data[at0003]/items[openEHR-EHR-CLUSTER.medication.v2]/items[at0132]']"</code></pre>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
